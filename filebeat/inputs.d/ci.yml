- type: httpjson
  config_version: 2
  interval: 345600s
  request.method: GET
  request.url: https://repositorio.ci.cultura.gob.mx/wp-json/tainacan/v2/collection/19207/items/?perpage=96&order=ASC&orderby=date&paged=1&exposer=json-flat
  response.split:
    target: body.items
  response.pagination:
    - set:
        target: url.value
        value: https://repositorio.ci.cultura.gob.mx/wp-json/tainacan/v2/collection/19207/items/?perpage=96&order=ASC&orderby=date&paged=1&exposer=json-flat
    - set:
        target: url.params.paged
        value: "[[.last_response.body.pagination.next_page]]"
    - set:
        target: body.perpage
        value: 50
  processors:
    - decode_json_fields:
        fields: [message]
        target: json
    - convert:
        mode: "rename"
        fields:
          - { from: "json.id", to: "payload.id" }
          - { from: "json.data.titulo-6.value", to: "payload.titulo" }
          - { from: "json.data.descripcion-6.value", to: "payload.descripcion" }
          - { from: "json.data.curaduria.value", to: "payload.curaduria" }
          - { from: "json.url", to: "payload.url" }
          - { from: "json.thumbnail", to: "payload.thumbnail" }
          - { from: "json.document", to: "payload.document" }
        ignore_missing: true
        fail_on_error: false
    - drop_fields:
        fields: ["message", "json"]
    - add_fields:
        target: payload
        fields:
          museu: "Centro de la Imagen Museo"
          colecao: "Acervo Mariana Yampolsky"
          cidade: "CDMX"
          uf: "MX"
